<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Quiz Challenge</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* 1. Reset & Dark Theme */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; }
        
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        /* 2. Main Quiz Container (Glass Card) */
        .quiz-container {
            width: 100%;
            max-width: 800px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px;
            box-shadow: 0 20px 50px rgba(0,0,0, 0.5);
            margin-top: 50px; /* Timer ke liye jagah */
        }

        h1 {
            text-align: center;
            color: #22c55e;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 15px rgba(34, 197, 94, 0.6);
        }

        /* 3. Question Styling */
        .question-box {
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 20px;
        }

        h4 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #e0e0e0;
        }

        /* 4. Options Styling (Custom Radio) */
        .choices { list-style: none; }
        
        .choices li { margin-bottom: 10px; }

        .choices label {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s;
            border: 1px solid transparent;
        }

        .choices label:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: #22c55e;
        }

        input[type="radio"] {
            margin-right: 15px;
            transform: scale(1.3);
            accent-color: #22c55e;
        }

        /* 5. Floating Timer */
        #timer-box {
            position: fixed;
            top: 20px; right: 20px;
            width: 100px; height: 100px;
            background: #222;
            border: 4px solid #22c55e;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.4);
            z-index: 1000;
        }
        #time-display { font-size: 32px; font-weight: bold; color: white; }
        .timer-label { font-size: 10px; color: #aaa; text-transform: uppercase; }

        /* 6. Action Buttons */
        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: 0.3s;
        }

        .submit-btn {
            background: #22c55e; color: white;
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.3);
        }
        .submit-btn:hover { transform: translateY(-3px); background: #16a34a; }

        .mail-btn {
            background: #3b82f6; color: white;
            display: none; /* Pehle chhupa rahega */
        }
        
        .logout-btn {
            background: #ff4444; color: white;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        /* 7. Results Area */
        #result-area {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: none; /* Initially Hidden */
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffd700; /* Gold Color */
        }
    </style>
</head>
<body>

    <div id="timer-box">
        <span class="timer-label">Time Left</span>
        <div id="time-display">60</div>
    </div>

    <div class="quiz-container">
        <h1>ðŸš€ Tech Master Quiz</h1>

        <div class="questions">
            <div class="question-box">
                <h4>1. What does "JS" stand for in web development?</h4>
                <ul class="choices">
                    <li><label><input type="radio" name="q0" value="A"> JavaSource</label></li>
                    <li><label><input type="radio" name="q0" value="B"> JavaScript</label></li>
                    <li><label><input type="radio" name="q0" value="C"> JustScript</label></li>
                    <li><label><input type="radio" name="q0" value="D"> JQueryScript</label></li>
                </ul>
            </div>

            <div class="question-box">
                <h4>2. Which symbol is used for comments in Python?</h4>
                <ul class="choices">
                    <li><label><input type="radio" name="q1" value="A"> //</label></li>
                    <li><label><input type="radio" name="q1" value="B"> /* */</label></li>
                    <li><label><input type="radio" name="q1" value="C"> #</label></li>
                    <li><label><input type="radio" name="q1" value="D"> --</label></li>
                </ul>
            </div>

            <div class="question-box">
                <h4>3. Which Django file handles URL routing?</h4>
                <ul class="choices">
                    <li><label><input type="radio" name="q2" value="A"> models.py</label></li>
                    <li><label><input type="radio" name="q2" value="B"> views.py</label></li>
                    <li><label><input type="radio" name="q2" value="C"> admin.py</label></li>
                    <li><label><input type="radio" name="q2" value="D"> urls.py</label></li>
                </ul>
            </div>

            <div class="question-box">
                <h4>4. What is the output of 2 + "2" in JavaScript?</h4>
                <ul class="choices">
                    <li><label><input type="radio" name="q3" value="A"> 4</label></li>
                    <li><label><input type="radio" name="q3" value="B"> "22"</label></li>
                    <li><label><input type="radio" name="q3" value="C"> Error</label></li>
                    <li><label><input type="radio" name="q3" value="D"> NaN</label></li>
                </ul>
            </div>

            <div class="question-box">
                <h4>5. Who developed Python?</h4>
                <ul class="choices">
                    <li><label><input type="radio" name="q4" value="A"> Guido van Rossum</label></li>
                    <li><label><input type="radio" name="q4" value="B"> Elon Musk</label></li>
                    <li><label><input type="radio" name="q4" value="C"> Bill Gates</label></li>
                    <li><label><input type="radio" name="q4" value="D"> Mark Zuckerberg</label></li>
                </ul>
            </div>
        </div>

        <div id="result-area"></div>

        <div class="actions">
            <button class="btn submit-btn" onclick="submitQuiz()">Submit Quiz</button>

            <form id="mail-form" action="/Test/SendMail/" method="POST" style="display:none;">
                {% csrf_token %}
                <input type="hidden" name="user_email" value="{{ request.session.user_email }}">
                <input type="hidden" name="score" id="hidden_score">
                <button type="submit" class="btn mail-btn" style="display:block; background:#3b82f6;">
                    ðŸ“© Email My Score
                </button>
            </form>

            <a href="/Test/logout/" class="btn logout-btn">Logout</a>
        </div>
    </div>

<script>
    // --- 1. CONFIGURATION ---
    const answers = ["B", "C", "D", "B", "A"]; // Correct Answers for 5 questions
    const totalQuestions = 5;
    let timeLeft = 60; // 60 Seconds Timer
    let timerInterval;
    let isSubmitted = false;

    // --- 2. TIMER LOGIC ---
    function startTimer() {
        if (timerInterval) return; // Agar pehle se chal raha hai toh return

        // Timer Box ka color change karein taaki user ko pata chale start ho gaya
        document.getElementById('timer-box').style.borderColor = "#ffeb3b"; // Yellow border

        timerInterval = setInterval(() => {
            timeLeft--;
            document.getElementById('time-display').innerText = timeLeft;

            // Danger Zone (Last 10 seconds)
            if (timeLeft <= 10) {
                document.getElementById('timer-box').style.borderColor = "#ff4444";
                document.getElementById('time-display').style.color = "#ff4444";
            }

            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                if(!isSubmitted) {
                    alert("Time's Up! Auto submitting...");
                    submitQuiz();
                }
            }
        }, 1000);
    }

    // --- 3. SUBMIT LOGIC ---
    function submitQuiz() {
        if (isSubmitted) return;
        isSubmitted = true;
        clearInterval(timerInterval);

        let score = 0;

        // Loop through all questions
        for (let i = 0; i < totalQuestions; i++) {
            let selected = document.querySelector(`input[name="q${i}"]:checked`);
            let correctVal = answers[i];
            
            // Logic to calculate score
            if (selected && selected.value === correctVal) {
                score++;
                // Sahi jawab ko Green karo
                selected.parentElement.style.background = "rgba(34, 197, 94, 0.4)";
                selected.parentElement.style.border = "1px solid #22c55e";
            } else if (selected) {
                // Galat jawab ko Red karo
                selected.parentElement.style.background = "rgba(255, 68, 68, 0.4)";
                selected.parentElement.style.border = "1px solid #ff4444";
            }
        }

        // 1. Show Result Area
        let resultDiv = document.getElementById('result-area');
        resultDiv.style.display = 'block';
        resultDiv.innerHTML = `ðŸŽ‰ You scored ${score} out of ${totalQuestions}`;

        // 2. Set Score in Hidden Input for Email
        document.getElementById('hidden_score').value = `${score}/${totalQuestions}`;

        // 3. Show Email Button & Hide Submit Button
        document.getElementById('mail-form').style.display = 'block';
        document.querySelector('.submit-btn').style.display = 'none';

        // 4. Disable all inputs (Cheat Proof)
        document.querySelectorAll('input[type="radio"]').forEach(el => el.disabled = true);
        
        // 5. Scroll to bottom
        window.scrollTo(0, document.body.scrollHeight);
    }

    // --- 4. START TIMER ON FIRST CLICK ---
    document.querySelectorAll('input[type="radio"]').forEach(el => {
        el.addEventListener('change', startTimer);
    });

    // --- 5. PREVENT REFRESH ---
    window.addEventListener("beforeunload", function (e) {
        if (!isSubmitted) {
            e.preventDefault();
            e.returnValue = "Quiz chal raha hai bhai! Refresh mat kar.";
        }
    });

</script>

</body>
</html>